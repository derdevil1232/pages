<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Roblox Hopper</title>
  <script>
    (function() {
      const url = new URL(window.location.href);
      const auto = url.searchParams.get("auto");

      const segments = window.location.pathname
        .split("/")
        .filter(Boolean);

      if (segments.length === 0) {
        document.write("No placeId supplied");
        return;
      }

      const placeId = segments[0];
      const instanceId = segments[1] || null;

      // If auto=1 missing, replace the current entry with auto=1 version
      if (!auto) {
        const target =
          "/" +
          placeId +
          (instanceId ? "/" + instanceId : "") +
          "?auto=1";

        // replace() overwrites the history entry
        // browser treats this as script navigation
        window.location.replace(target);
        return;
      }

      // Auto mode: launch Roblox
      let robloxURL = "roblox://experiences/start?placeId=" + encodeURIComponent(placeId);
      if (instanceId) {
        robloxURL += "&gameInstanceId=" + encodeURIComponent(instanceId);
      }

      window.location.href = robloxURL;

      // Now allowed to close because history entry was script-replaced
      setTimeout(() => {
        try { window.close(); } catch (e) {}
      }, 30000);
    })();
  </script>
</head>
<body></body>
</html>
